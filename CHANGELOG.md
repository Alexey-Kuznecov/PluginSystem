# Changelog

Все заметные изменения этого проекта будут задокументированы в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),  
и этот проект придерживается [семантического версионирования](https://semver.org/lang/ru/).

## [Unreleased]
### Added
- `feat(core)`: реализация системы настроек и плагиновых консольных команд.
- Интерфейс `IPluginSettingsService` и его реализация.
- Интерфейс `IConsoleCommandRegistry` для регистрации пользовательских команд.
- `ConsoleCommandDispatcher` с поддержкой DI.
- Поддержка пользовательских команд через `IPluginCommandHost`.
- Шаблон фасада `IConsoleSystem` (реализация позже).
- `feat(plugin)`: интерфейс `IPluginUnloadable` для безопасной выгрузки плагинов из памяти.
- Механизмы отписки от событий внутри `PluginSettings<T>` и других классов.
- Интерфейс `IPluginSettings` и его реализация в `PluginSettings`.
- Автосохранение настроек при изменении свойств через `PropertyChanged`.

### Changed
- Улучшено отображение ID плагинов в логах и консоли.
- Обновлён `NLogLoggerService`, настроен на вывод в консоль.
- Все `Console.WriteLine` заменены на вызовы логгера с соответствующими уровнями.
- В `PluginManager` добавлена зависимость `PluginPersistenceService`.
- Методы плагин-менеджера сгруппированы в регион `#region Persistence`.
- Реализована логгируемая загрузка плагинов с выводом успешных/неуспешных кейсов.
- `refactor`: удалён `INotifyPropertyChanged` для проверки корректной выгрузки.
- Проверяется замена `INotifyPropertyChanged` на собственную модель подписок.

### Removed
- Удалён плагин `ClockPlugin` как устаревший и неподдерживаемый.
- Удалён `JsonPluginInfoService`, логика перенесена в `PluginPersistenceService`.

### Fixed
- Исправлена реализация `PluginInitContext` с корректной инициализацией `PluginContext`.
- Добавлена очистка ссылок в `PluginContainer` при выгрузке.
- Реализована первичная проверка успешной выгрузки через `WeakReference`.
- Удалены зависимости, мешавшие сборке выгружаться (например, `PluginSettings`).
- Добавлен `try/catch` в команду `list` для предотвращения падения при отсутствии свойств плагина.

---

## [0.1.0] - 2025-04-10
### Added
- Начальная реализация системы плагинов.
- Структура плагина с интерфейсами `IPlugin`, `IPluginContext`.
- Пример плагина с базовой функциональностью.
- Простая консольная команда `list` для отображения загруженных плагинов.
